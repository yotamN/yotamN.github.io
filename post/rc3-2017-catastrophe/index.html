<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>[RC3-2017 CTF] Catastrophe</title>
  <meta property="og:title" content="[RC3-2017 CTF] Catastrophe" />
  <meta name="twitter:title" content="[RC3-2017 CTF] Catastrophe" />
  <meta name="description" content="Writeup by WelloWorld">
  <meta property="og:description" content="Writeup by WelloWorld">
  <meta name="twitter:description" content="Writeup by WelloWorld">
  <meta name="author" content="noxale"/>
  <link href='http://localhost:1313/favicon.png' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="http://localhost:1313/logo.png" />
  <meta name="twitter:image" content="http://localhost:1313/logo.png" />
  <meta name="twitter:card" content="summary" />
  <meta property="og:url" content="http://localhost:1313/post/rc3-2017-catastrophe/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="noxale" />

  <meta name="generator" content="Hugo 0.30" />
  <link rel="canonical" href="http://localhost:1313/post/rc3-2017-catastrophe/" />
  <link rel="alternate" href="" type="application/rss+xml" title="noxale">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="http://localhost:1313/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="http://localhost:1313/css/highlighting.css" />
  <link rel="stylesheet" href="http://localhost:1313/css/pygment_highlights.css" />
  <link rel="stylesheet" href="http://localhost:1313/css/highlight.min.css" />


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css" integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css" integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin="anonymous" />



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://localhost:1313">noxale</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="http://localhost:1313/">Blog</a>
            </li>
          
        
          
            <li>
              <a title="About" href="http://localhost:1313/page/about/">About</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="http://localhost:1313/tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="noxale" href="http://localhost:1313">
            <img class="avatar-img" src="http://localhost:1313/logo.png" alt="noxale" />
          </a>
        
      </div>
    </div>

  </div>
</nav>




    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              <h1>[RC3-2017 CTF] Catastrophe</h1>
                
                  
                    <h2 class="post-subheading">Writeup by WelloWorld</h2>
                  
                
                
                  <span class="post-meta">
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on 2017-12-01
  &nbsp;|&nbsp; <i class="fa fa-clock-o"></i> 2 min (275 mots)
  
</span>


                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p>In the beginning, you get a Pcap file that contains 3200 packets of data. The
description told us that while one friend went to somewhere and forgot his
computer open, his friend took his computer and entered to sites of cat pics.
He want to know more about what his friend did and luckily for him, he forgot
his Wireshark on. So we know we’re searching for cat pics right now. The first
thing I did was to search if some packets contain cat.png or cat.jpg:</p>

<p><img src="1.png" alt="Wireshark Screenshot" /></p>

<p>Oh, look at these two packets, Now lets look on their ‘follow tcp-stream’:</p>

<p><img src="2.png" alt="HTTP Request Screenshot" />
<img src="3.png" alt="HTTP Request Screenshot" /></p>

<p>Now, which one is more relevant to us? Of course the second one, Lets have a
look on this after converting it to ‘Raw’ bytes.</p>

<p><img src="4.png" alt="Raw Packet Screenshot" /></p>

<p>You can see there are a start of jpg file (‘ffd8’) right in the start of the
second blue packet. Now let’s find where it ends(&lsquo;ffd9&rsquo;):</p>

<p><img src="5.png" alt="Raw Packet Screenshot" /></p>

<p>Right in the end of the conversation.<br />
OK, lets filter it only for what the server sent to me, stay in ‘Raw’ mode and
copy all the data from the screen and paste it in a local file on my computer.
Now, we can see that the headers of the packet are still there and we must
delete them to make that picture again:</p>

<p><img src="6.png" alt="Raw Packet in Sublime Text" /></p>

<p>Then, we need to two things, first- delete every new line, because of the
copy-paste from the Wireshark raw, and second- run on the hexadecimal we found,
make every two characters to a real hex, and write them in a binary file. I made
a python script to do it:</p>

<p><img src="7.png" alt="Python Code" /></p>

<p>And an image file named flag created in the same directory:</p>

<p><img src="8.jpg" alt="A Picture of a Cat With The Flag" /></p>

      </article>

      <ul class="pager blog-pager">
        
        
          <li class="next">
            <a href="http://localhost:1313/post/rc3-2017-knocker/" data-toggle="tooltip" data-placement="top" title="[RC3–2017 CTF] knocker">Next Post &rarr;</a>
          </li>
        
      </ul>


      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="https://www.facebook.com/noxale" title="Facebook">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://linkedin.com/in/../company/noxale" title="LinkedIn">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              noxale
            
          

          &nbsp;&bull;&nbsp;
          2017

          
            &nbsp;&bull;&nbsp;
            <a href="http://localhost:1313">noxale</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.30</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="http://localhost:1313/js/main.js"></script>
<script src="http://localhost:1313/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script><script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js" integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js" integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin="anonymous"></script>
<script src="http://localhost:1313/js/load-photoswipe.js"></script>



  </body>
</html>

